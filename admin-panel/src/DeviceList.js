import './DeviceList.css';

import React from 'react';
import Device from "./Device";
import {ListGroup, ListGroupItem} from "react-bootstrap";
import uniqueHash from "unique-hash"


class DeviceList extends React.Component {
    constructor(props) {
        super(props);

        const {devices} = props;

        this.counter = 0;

        this.state = {
            devices: devices,
            active: null,
        };
    }

    setDevices(devices) {
        let deviceList = {};
        devices.forEach(device => {
            const hash = uniqueHash(JSON.stringify(device), {format:"string"});
            console.log('hash ' + hash);
            device.hash = hash;
            device.ref = React.createRef();
            deviceList[hash] = device;
        })
        this.setState({devices: deviceList});
    }

    renderDevice(device) {
        const { hash, name, mac, signal, ref } = device;

        return (
            <Device
                key={hash}
                ref={ref}
                hash={hash}
                name={name}
                mac={mac}
                signal={signal}/>
        );
    }

    render() {
        console.log('device-list rendering...')
        console.log(this.state);
        const onClick = event => {
            const hash = event.target.getAttribute('hash');
            this.state.devices[hash].ref.current.select();
        };
        return (
            <ListGroup className='device-list' onClick={onClick}>
                {this.state.devices
                    ? Object.values(this.state.devices).map(device => this.renderDevice(device))
                    : <ListGroupItem>No devices</ListGroupItem>}
            </ListGroup>
        );
    }
}


export default DeviceList;
